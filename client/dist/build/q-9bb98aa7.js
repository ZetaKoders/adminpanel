import{w as C,f as k,v as _,_ as E,j as w,k as M,V as W,m as B}from"./q-650288c1.js";import{E as H}from"./q-7440b369.js";var K=Object.defineProperty,U=(t,e,i)=>e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,T=(t,e,i)=>(U(t,typeof e!="symbol"?e+"":e,i),i);class he extends Error{constructor(e,i){super(typeof e=="string"?e:""),T(this,"name","FormError"),T(this,"errors"),this.errors=typeof e=="string"?i||{}:e}}function _e(t,e,i){const{checked:r,files:n,options:s,value:o,valueAsDate:a,valueAsNumber:c}=t;return!i||i==="string"?o:i==="string[]"?s?[...s].filter(l=>l.selected&&!l.disabled).map(l=>l.value):r?[...e.value||[],o]:(e.value||[]).filter(l=>l!==o):i==="number"?c:i==="boolean"?r:i==="File"&&n?k(n[0]):i==="File[]"&&n?[...n].map(l=>k(l)):i==="Date"&&a?a:e.value}function N(t){return[...Object.values(t.internal.fields),...Object.values(t.internal.fieldArrays)]}function F(t,e){return t.internal.fieldArrays[e]}function X(t,e){return+e.replace(`${t}.`,"").split(".")[0]}function R(t,e){$(t,!1).forEach(i=>{const r=F(t,i).items.length-1;e.filter(n=>n.startsWith(`${i}.`)&&X(i,n)>r).forEach(n=>{e.splice(e.indexOf(n),1)})})}function $(t,e=!0){const i=Object.keys(t.internal.fieldArrays);return e&&R(t,i),i}function Y(t,e=!0){const i=Object.keys(t.internal.fields);return e&&R(t,i),i}function A(t,e){return t.internal.fields[e]}function O(t,e,i){const r=Y(t,i),n=$(t,i);return typeof e=="string"||Array.isArray(e)?(typeof e=="string"?[e]:e).reduce((s,o)=>{const[a,c]=s;return n.includes(o)?(n.forEach(l=>{l.startsWith(o)&&c.add(l)}),r.forEach(l=>{l.startsWith(o)&&a.add(l)})):a.add(o),s},[new Set,new Set]).map(s=>[...s]):[r,n]}function Z(t,{items:e,initialItems:i,error:r}={items:[],initialItems:[],error:""}){const n=i.join()!==e.join();return{internal:{initialItems:[...i],startItems:[...i],validate:[],consumers:[]},name:t,items:e,error:r,active:!1,touched:n,dirty:n}}function L(t,e){const i=r=>r instanceof Blob?r.size:r;return Array.isArray(t)&&Array.isArray(e)?t.map(i).join()!==e.map(i).join():t instanceof Date&&e instanceof Date?t.getTime()!==e.getTime():Number.isNaN(t)&&Number.isNaN(e)?!1:t!==e}function G(t,{value:e,initialValue:i,error:r}={value:void 0,initialValue:void 0,error:""}){const n=L(i,e);return{internal:{initialValue:i,startValue:i,validate:[],transform:[],elements:[],consumers:[]},name:t,value:e,error:r,active:!1,touched:n,dirty:n}}function I(t,e){return t.split(".").reduce((i,r)=>i==null?void 0:i[r],e)}let J=0;function D(){return J++}function ee({loader:t,action:e,fieldArrays:i}){function r(a){var c;return((c=e==null?void 0:e.value)==null?void 0:c.values)&&I(a,e.value.values)}const n=()=>D(),s=a=>{var c;return((c=e==null?void 0:e.value)==null?void 0:c.errors[a])||""},o=(a,c,l)=>Object.entries(c).reduce((y,[d,u])=>{var p;const f=l?`${l}.${d}`:d;if(i!=null&&i.includes(f.replace(/.\d+./g,".$."))){const h=u.map(n);y[1][f]=Z(f,{initialItems:h,items:((p=r(f))==null?void 0:p.map(n))||[...h],error:s(f)})}else(!u||typeof u!="object"||Array.isArray(u)||u instanceof Date)&&(y[0][f]=G(f,{initialValue:u,value:r(f)??u,error:s(f)}));return u&&typeof u=="object"&&o(y,u,f),y},a);return o([{},{}],t.value)}async function Ee(t,e){const i=await t.resolve();return(typeof i=="function"?i():i).safeParse(e)}function P(t,e){return(typeof t!="string"&&!Array.isArray(t)?t:e)||{}}function te(t,e){t.dirty=e||N(t).some(i=>i.active&&i.dirty)}function ie(t,e){const i=L(e.internal.startValue,e.value);i!==e.dirty&&(e.dirty=i,te(t,i))}function Q(t,e){var i,r;(r=(i=A(t,e))==null?void 0:i.internal.elements[0])==null||r.focus()}function re(t,e,i,{shouldActive:r=!0,shouldTouched:n=!1,shouldDirty:s=!1,shouldFocus:o=!!i}={}){for(const a of[A(t,e),F(t,e)])a&&(!r||a.active)&&(!n||a.touched)&&(!s||a.dirty)&&(a.error=i,i&&"value"in a&&o&&Q(t,e));q(t,!!i)}function ne(t,e,i){const{shouldActive:r=!0,shouldTouched:n=!1,shouldDirty:s=!1,shouldValid:o=!1}=P(e,i);return O(t,e)[0].reduce((a,c)=>{const l=A(t,c);return(!r||l.active)&&(!n||l.touched)&&(!s||l.dirty)&&(!o||!l.error)&&(typeof e=="string"?c.replace(`${e}.`,""):c).split(".").reduce((y,d,u,f)=>y[d]=u===f.length-1?l.value:typeof y[d]=="object"&&y[d]||(isNaN(+f[u+1])?{}:[]),a),a},typeof e=="string"?[]:{})}function Ae(t,e,i){const[r,n]=O(t,e,!1),s=typeof e=="string"&&r.length===1,o=!s&&!Array.isArray(e),a=P(e,i),{initialValue:c,initialValues:l,keepResponse:y=!1,keepSubmitCount:d=!1,keepSubmitted:u=!1,keepValues:f=!1,keepDirtyValues:p=!1,keepItems:h=!1,keepDirtyItems:z=!1,keepErrors:S=!1,keepTouched:V=!1,keepDirty:j=!1}=a;r.forEach(b=>{const v=A(t,b);(s?"initialValue"in a:l)&&(v.internal.initialValue=s?c:I(b,l));const m=p&&v.dirty;!f&&!m&&(v.internal.startValue=v.internal.initialValue,v.value=v.internal.initialValue,v.internal.elements.forEach(g=>{g.type==="file"&&(g.value="")})),V||(v.touched=!1),!j&&!f&&!m&&(v.dirty=!1),S||(v.error="")}),n.forEach(b=>{var g;const v=F(t,b),m=z&&v.dirty;!h&&!m&&(l&&(v.internal.initialItems=((g=I(b,l))==null?void 0:g.map(()=>D()))||[]),v.internal.startItems=[...v.internal.initialItems],v.items=[...v.internal.initialItems]),V||(v.touched=!1),!j&&!h&&!m&&(v.dirty=!1),S||(v.error="")}),o&&(y||(t.response={}),d||(t.submitCount=0),u||(t.submitted=!1)),ue(t)}function se(t,e,{duration:i}={}){t.response=e,i&&setTimeout(()=>{t.response===e&&(t.response={})},i)}async function ae(t,e,i){const[r,n]=O(t,e),{shouldActive:s=!0,shouldFocus:o=!0}=P(e,i),a=D();t.internal.validators.push(a),t.validating=!0;const c=t.internal.validate?await t.internal.validate(ne(t,{shouldActive:s})):{};let l=typeof e!="string"&&!Array.isArray(e)?!Object.keys(c).length:!0;const[y]=await Promise.all([Promise.all(r.map(async d=>{const u=A(t,d);if(!s||u.active){let f;for(const h of u.internal.validate)if(f=await h(u.value),f)break;const p=f||c[d]||"";return p&&(l=!1),u.error=p,p?d:null}})),Promise.all(n.map(async d=>{const u=F(t,d);if(!s||u.active){let f="";for(const h of u.internal.validate)if(f=await h(u.items),f)break;const p=f||c[d]||"";p&&(l=!1),u.error=p}}))]);if(oe(t,c,{shouldActive:s}),o){const d=y.find(u=>u);d&&Q(t,d)}return q(t,!l),t.internal.validators.splice(t.internal.validators.indexOf(a),1),t.internal.validators.length||(t.validating=!1),l}function le(t,e,i,{on:r,shouldFocus:n=!1}){r.includes((t.internal.validateOn==="submit"?t.submitted:e.error)?t.internal.revalidateOn:t.internal.validateOn)&&ae(t,i,{shouldFocus:n})}async function Fe(t,e,i,r,n,s,o){o!==void 0&&(e.value=o);for(const a of e.internal.transform)e.value=await a(e.value,r,n);e.touched=!0,t.touched=!0,ie(t,e),le(t,e,i,{on:s})}function oe(t,e,{duration:i,shouldActive:r=!0}){const n=Object.entries(e).reduce((s,[o,a])=>([A(t,o),F(t,o)].every(c=>!c||r&&!c.active)&&s.push(a),s),[]).join(" ");n&&se(t,{status:"error",message:n},{duration:i})}function be(t,e,i){Object.entries(e).forEach(([r,n])=>{n&&re(t,r,n,{...i,shouldFocus:!1})})}function q(t,e){t.invalid=e||N(t).some(i=>i.active&&i.error)}function ue(t){let e=!1,i=!1,r=!1;for(const n of N(t))if(n.active&&(n.touched&&(e=!0),n.dirty&&(i=!0),n.error&&(r=!0)),e&&i&&r)break;t.touched=e,t.dirty=i,t.invalid=r}function me(t,e){return H(C("s_VOLgKQUpNuc",[t,e]),{id:t.getHash()})}function ge(t){return _(()=>E(()=>import("./q-a1ca213b.js"),["build/q-a1ca213b.js","build/q-650288c1.js"]),"s_b4MyjhrwMxE",[t])}const x=B(_(()=>E(()=>import("./q-bd2c1bb7.js"),["build/q-bd2c1bb7.js","build/q-650288c1.js","build/q-7440b369.js"]),"s_vBVRkPF8kFE"));function ce({children:t,name:e,type:i,...r}){const{of:n}=r,s=A(n,e);return w(x,{store:s,...r,children:t(s,{name:e,autoFocus:!1,ref:_(()=>E(()=>import("./q-313dbe56.js"),["build/q-313dbe56.js","build/q-650288c1.js","build/q-7440b369.js"]),"s_0EFsQ07yXsM",[s]),onInput$:_(()=>E(()=>import("./q-313dbe56.js"),["build/q-313dbe56.js","build/q-650288c1.js","build/q-7440b369.js"]),"s_WQShqIriXzI",[s,n,e,i]),onChange$:_(()=>E(()=>import("./q-313dbe56.js"),["build/q-313dbe56.js","build/q-650288c1.js","build/q-7440b369.js"]),"s_vNtVq2dMPhY",[s,n,e]),onBlur$:_(()=>E(()=>import("./q-313dbe56.js"),["build/q-313dbe56.js","build/q-650288c1.js","build/q-7440b369.js"]),"s_fzfym1ErEFI",[s,n,e])})},0,e)}function fe({children:t,name:e,...i}){const r=F(i.of,e);return w(x,{store:r,...i,children:t(r)},0,e)}function de({of:t,action:e,onSubmit$:i,responseDuration:r,keepResponse:n,shouldActive:s,shouldTouched:o,shouldDirty:a,shouldFocus:c,reloadDocument:l,children:y,...d}){const{encType:u}=d,f={duration:r,shouldActive:s,shouldTouched:o,shouldDirty:a,shouldFocus:c};return M("form",{...d,action:e==null?void 0:e.actionPath,children:y,onSubmit$:_(()=>E(()=>import("./q-73ed8726.js"),["build/q-73ed8726.js","build/q-650288c1.js","build/q-7440b369.js"]),"s_qmKnyqz75p4",[e,u,t,n,i,f,l]),"preventdefault:submit":!l,ref:p=>{t.element=p}},{method:"post",noValidate:!0},0,"Qg_0")}function ve({validate:t,validateOn:e="submit",revalidateOn:i="input",...r}){return W(()=>{var o,a;const[n,s]=ee(r);return{internal:{fields:n,fieldArrays:s,fieldArrayPaths:r.fieldArrays,validate:t,validators:[],validateOn:e,revalidateOn:i},element:void 0,submitCount:0,submitting:!1,submitted:!1,validating:!1,touched:!1,dirty:!1,invalid:!1,response:((a=(o=r.action)==null?void 0:o.value)==null?void 0:a.response)||{}}})}function Ie(t){const e=ve(t);return[e,{Form:i=>de({of:e,action:t.action,...i}),Field:i=>ce({of:e,...i}),FieldArray:i=>fe({of:e,...i})}]}export{he as F,ae as a,ne as b,se as c,oe as d,ue as e,D as f,_e as g,Fe as h,me as i,Ee as j,Ae as r,be as s,Ie as u,ge as v};
